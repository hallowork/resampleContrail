# HDF文件瘦身处理程序

这个程序用于处理HDF文件，只保留经纬度数据（'Latitude'和'Longitude'），删除其他所有参数，从而达到瘦身的目的。

## 功能特点

- **并行处理**: 支持多worker并行处理，提高处理速度
- **文件瘦身**: 只保留经纬度数据，大幅减少文件大小
- **详细日志**: 记录处理过程和结果统计
- **错误处理**: 对处理失败的文件进行记录，不影响其他文件处理
- **效率统计**: 计算瘦身效率，显示节省的存储空间

## 文件结构

```
removeMod03data/
├── hdf_processor.py    # 核心处理模块
├── main.py            # 主程序
├── demo.py            # 演示程序（使用模拟数据）
├── test_hdf_files.py  # HDF文件测试工具
├── simple_test.py     # 简单测试工具
├── requirements.txt   # 依赖包列表
├── README.md          # 说明文档
├── log.txt            # 处理日志（运行后生成）
├── demo_log.txt       # 演示程序日志
└── demo_files/        # 演示文件目录
    ├── demo_file_001.hdf
    ├── demo_file_002.hdf
    └── ...
```

## 使用方法

### 1. 基本使用（使用默认参数）

```bash
python main.py
```

默认参数：
- 输入文件夹: `C:\Users\wuch\Documents`
- Worker数量: 5
- 日志文件: `log.txt`

### 2. 自定义参数

```bash
# 指定输入文件夹和worker数量
python main.py --input-folder "D:\MyData" --workers 8

# 或者使用短参数
python main.py -i "D:\MyData" -w 8

# 指定日志文件名
python main.py --log-file "my_log.txt"
```

### 3. 查看帮助

```bash
python main.py --help
```

### 4. 运行演示程序

如果您想先测试程序功能，可以运行演示程序：

```bash
python demo.py
```

演示程序会：
- 创建5个模拟的HDF文件（包含经纬度和其他数据）
- 处理这些文件，只保留经纬度数据
- 显示瘦身效果（通常能达到80%左右的效率）

## 参数说明

| 参数 | 短参数 | 默认值 | 说明 |
|------|--------|--------|------|
| `--input-folder` | `-i` | `C:\Users\wuch\Documents` | 输入文件夹路径 |
| `--workers` | `-w` | `5` | 并行处理的worker数量 |
| `--log-file` | `-l` | `log.txt` | 日志文件名 |

## 输出结果

程序会输出以下信息：

1. **处理统计**:
   - 总文件数
   - 成功处理文件数
   - 处理失败文件数

2. **大小统计**:
   - 原始总大小（MB）
   - 缩减后总大小（MB）
   - 总体瘦身效率（%）

3. **详细日志**:
   - 每个文件的处理结果
   - 处理时间
   - 错误信息（如果有）

## 示例输出

```
============================================================
处理完成！
============================================================
总文件数: 100
成功处理: 98 个文件
处理失败: 2 个文件
原始总大小: 2048.50 MB
缩减后总大小: 512.25 MB
总体瘦身效率: 75.0%
处理时间: 0:05:30
详细日志: log.txt
```

## 注意事项

1. **备份重要数据**: 程序会直接修改原文件，建议先备份重要数据
2. **文件格式**: 支持 `.hdf`, `.HDF`, `.h5`, `.H5` 格式的文件
3. **内存使用**: 处理大文件时可能需要较多内存，建议根据系统配置调整worker数量
4. **错误处理**: 如果某个文件处理失败，程序会继续处理其他文件，并在日志中记录错误信息

## 依赖包

确保安装了以下Python包：

```bash
pip install h5py numpy
```

## 系统要求

- Python 3.6+
- Windows/Linux/macOS
- 足够的磁盘空间用于临时文件处理
